-- Anya Hub Mini UI (Drag fixed - 2025)
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")

-- ScreenGui
local gui = Instance.new("ScreenGui")
gui.Name = "AnyaHubUI"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
gui.Parent = player:WaitForChild("PlayerGui")

-- Avatar button (toggle UI)
local avatarBtn = Instance.new("ImageButton", gui)
avatarBtn.Name = "AvatarButton"
avatarBtn.Size = UDim2.new(0, 60, 0, 60)
avatarBtn.Position = UDim2.new(0, 20, 0, 20)
avatarBtn.BackgroundTransparency = 1
avatarBtn.Image = "rbxthumb://type=AvatarHeadShot&id=" .. player.UserId .. "&w=420&h=420"
avatarBtn.ScaleType = Enum.ScaleType.Fit
Instance.new("UICorner", avatarBtn).CornerRadius = UDim.new(1, 0)
local avatarStroke = Instance.new("UIStroke", avatarBtn)
avatarStroke.Thickness = 2
avatarStroke.Color = Color3.fromRGB(0, 150, 255)

-- Main frame
local main = Instance.new("Frame", gui)
main.Name = "MainFrame"
main.Size = UDim2.new(0, 580, 0, 340)
main.Position = UDim2.new(0.5, -290, 0.5, -170)
main.BackgroundColor3 = Color3.fromRGB(23, 40, 28)
main.BorderSizePixel = 0
main.Active = true
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 10)

-- üü© DRAG ch·ªâ b·∫±ng thanh ti√™u ƒë·ªÅ
local top = Instance.new("Frame", main)
top.Name = "TopBar"
top.Size = UDim2.new(1, 0, 0, 30)
top.BackgroundColor3 = Color3.fromRGB(18, 30, 22)
top.BorderSizePixel = 0
Instance.new("UICorner", top).CornerRadius = UDim.new(0, 10)
top.Active = true

local dragging = false
local dragStart, startPos

local function updateDrag(input)
	local delta = input.Position - dragStart
	main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

top.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = main.Position
	end
end)

top.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = false
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
		updateDrag(input)
	end
end)

-- Title
local title = Instance.new("TextLabel", top)
title.Text = "Anya Hub | Blox Fruits [BETA]"
title.Font = Enum.Font.GothamSemibold
title.TextSize = 15
title.TextColor3 = Color3.fromRGB(230, 230, 230)
title.BackgroundTransparency = 1
title.Position = UDim2.new(0, 12, 0, 0)
title.Size = UDim2.new(1, -150, 1, 0)
title.TextXAlignment = Enum.TextXAlignment.Left

local author = Instance.new("TextLabel", top)
author.Text = "by Sakura"
author.Font = Enum.Font.Gotham
author.TextSize = 13
author.TextColor3 = Color3.fromRGB(160, 160, 160)
author.BackgroundTransparency = 1
author.Size = UDim2.new(0, 100, 1, 0)
author.Position = UDim2.new(1, -110, 0, 0)
author.TextXAlignment = Enum.TextXAlignment.Right

-- Sidebar
local sidebar = Instance.new("Frame", main)
sidebar.Size = UDim2.new(0, 130, 1, -30)
sidebar.Position = UDim2.new(0, 0, 0, 30)
sidebar.BackgroundColor3 = Color3.fromRGB(20, 35, 25)
sidebar.BorderSizePixel = 0
sidebar.Active = true
Instance.new("UICorner", sidebar).CornerRadius = UDim.new(0, 6)

local buttons = {"Home", "Farming", "Player", "Misc", "Settings"}

-- Content
local content = Instance.new("Frame", main)
content.Size = UDim2.new(1, -160, 1, -60)
content.Position = UDim2.new(0, 150, 0, 55)
content.BackgroundTransparency = 1

local title2 = Instance.new("TextLabel", content)
title2.Text = "Farming"
title2.Font = Enum.Font.GothamBold
title2.TextSize = 24
title2.TextColor3 = Color3.fromRGB(240, 240, 240)
title2.BackgroundTransparency = 1
title2.Position = UDim2.new(0, 0, 0, 0)
title2.Size = UDim2.new(1, 0, 0, 35)
title2.TextXAlignment = Enum.TextXAlignment.Left

-- Option generator (toggle)
local function createOption(y, name, desc)
	local frame = Instance.new("Frame", content)
	frame.Size = UDim2.new(1, -20, 0, 50)
	frame.Position = UDim2.new(0, 0, 0, y)
	frame.BackgroundColor3 = Color3.fromRGB(25, 45, 30)
	frame.BorderSizePixel = 0
	frame.Active = true
	Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)

	local title = Instance.new("TextLabel", frame)
	title.Text = name
	title.Font = Enum.Font.GothamSemibold
	title.TextSize = 17
	title.TextColor3 = Color3.fromRGB(230, 230, 230)
	title.BackgroundTransparency = 1
	title.Size = UDim2.new(0.7, 0, 0, 20)
	title.Position = UDim2.new(0, 12, 0, 6)

	local descText = Instance.new("TextLabel", frame)
	descText.Text = desc
	descText.Font = Enum.Font.Gotham
	descText.TextSize = 13
	descText.TextColor3 = Color3.fromRGB(160, 160, 160)
	descText.BackgroundTransparency = 1
	descText.Size = UDim2.new(0.9, 0, 0, 16)
	descText.Position = UDim2.new(0, 12, 0, 26)

	local toggle = Instance.new("TextButton", frame)
	toggle.Size = UDim2.new(0, 50, 0, 26)
	toggle.Position = UDim2.new(1, -70, 0.5, -13)
	toggle.BackgroundColor3 = Color3.fromRGB(15, 25, 20)
	toggle.AutoButtonColor = false
	toggle.Text = ""
	toggle.Active = true
	Instance.new("UICorner", toggle).CornerRadius = UDim.new(0, 15)

	local knob = Instance.new("Frame", toggle)
	knob.Size = UDim2.new(0, 22, 0, 22)
	knob.Position = UDim2.new(0, 2, 0.5, -11)
	knob.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
	Instance.new("UICorner", knob).CornerRadius = UDim.New(1, 0)

	local isOn = false
	toggle.MouseButton1Click:Connect(function()
		isOn = not isOn
		if isOn then
			knob:TweenPosition(UDim2.new(1, -24, 0.5, -11), "Out", "Sine", 0.15, true)
			knob.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
		else
			knob:TweenPosition(UDim2.new(0, 2, 0.5, -11), "Out", "Sine", 0.15, true)
			knob.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
		end
	end)
end

-- Hi·ªÉn th·ªã danh m·ª•c
local function clearContent()
	for _, child in ipairs(content:GetChildren()) do
		if child:IsA("Frame") then child:Destroy() end
	end
end

function showCategory(name)
	clearContent()
	if name == "Home" then
		createOption(50, "Welcome", "Welcome to Anya Hub")
	elseif name == "Farming" then
		createOption(50, "Auto Farm Level", "Autofarms quests and mobs")
		createOption(110, "Farm Nearest Mob", "Autofarms nearest mobs")
		createOption(170, "Include Bosses", "Include bosses in routine")
	elseif name == "Player" then
		createOption(50, "Speed Boost", "Increase your movement speed")
		createOption(110, "Jump Boost", "Increase your jump height")
	elseif name == "Misc" then
		createOption(50, "Collect Chest", "Automatically collect chests around you")
	elseif name == "Settings" then
		createOption(50, "Toggle UI", "Hide or show this menu with avatar button")
	end
end

-- Sidebar buttons
for i, name in ipairs(buttons) do
	local btn = Instance.new("TextButton", sidebar)
	btn.Size = UDim2.new(1, 0, 0, 34)
	btn.Position = UDim2.new(0, 0, 0, (i - 1) * 38 + 10)
	btn.BackgroundColor3 = (name == "Farming") and Color3.fromRGB(35, 60, 40) or Color3.fromRGB(20, 35, 25)
	btn.Text = name
	btn.Font = Enum.Font.Gotham
	btn.TextSize = 15
	btn.TextColor3 = Color3.fromRGB(230, 230, 230)
	btn.AutoButtonColor = false
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 6)

	btn.MouseButton1Click:Connect(function()
		for _, b in ipairs(sidebar:GetChildren()) do
			if b:IsA("TextButton") then
				b.BackgroundColor3 = Color3.fromRGB(20, 35, 25)
			end
		end
		btn.BackgroundColor3 = Color3.fromRGB(35, 60, 40)
		title2.Text = name
		showCategory(name)
	end)
end

-- M·∫∑c ƒë·ªãnh hi·ªÉn th·ªã
showCategory("Farming")

-- Toggle UI visibility
local visible = true
avatarBtn.MouseButton1Click:Connect(function()
	visible = not visible
	main.Visible = visible
end)
